<div class="row">
    <div class="col-12">
        <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
        <h2 class="text-center text-primary">Dodaj Nowy trening</h2>
        <hr>    
        Value: {{ myForm.value | json }}    
        <hr>  

        <div class="row">
            <!-- Podopieczny  -->
            <div class="col-12">
                <h4>Wybierz podopiecznego</h4>
                <mat-form-field>
                <mat-select placeholder="Podopieczny" [(value)]="selection" [formControl]="selectionControl" required>
                    <mat-option>None</mat-option>
                    <mat-option *ngFor="let pupil of pupils?.object?.users" [value]="pupil.id">{{ pupil.userName }}</mat-option>
                </mat-select>
                <mat-error *ngIf="selectionControl.hasError('required')">Musisz wybrać podopiecznego</mat-error>
                </mat-form-field>
            </div>
            <!-- Nazwa treningu -->
            <div class="col-12">
                <h4>Podaj nazwę treningu</h4>
                <mat-form-field class="full">
                    <input matInput placeholder="Podaj nazwe treningu" formControlName="name" required> 
                </mat-form-field>
            </div>
            <div class="col-12">
                <h4>Data rozpoczęcia</h4>
            </div>
            <div class="col-12">
                <h4>Data zakończenia</h4>
            </div>
        </div>
        
        <div class="row">
            <div class="col-12 col-md-6">
                <div cdkDropList class="example-list" (cdkDropListDropped)="drop1($event)" formArrayName="trainingDayBindingModels">
                    <div [id]="ix" *ngFor="let days of myForm['controls'].trainingDayBindingModels['controls']; let ix=index" [formGroupName]="ix" class="trainingDay" cdkDrag #elem="cdkDrag" (mouseenter)="enter1(ix)">                      

                        <div class="row mb-3 mt-3 margin">
                            <i class="fa fa-arrows" aria-hidden="true" cdkDragHandle></i>
                            <div class="col-12 mt-3 delete mt-3">                                  
                                <i *appHasRole="['Trainer']" (click)="deleteX(ix)" matTooltip="Usuń trening" class="material-icons clear-icon">
                                    clear
                                </i>    
                            </div>
                            <div class="col-12 col-md-4 margin">
                                <mat-form-field class="xs">
                                    <input matInput placeholder="Dzień treningowy" formControlName="day" required>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-md-4 margin">
                                <mat-form-field class="xs">
                                    <input matInput placeholder="Rodzaj treningu" formControlName="typeOfTraining" required>
                                </mat-form-field>
                            </div>
                        </div>  

                        <!-- exercisex -->
                        <div class="row">
                            <div class="mb-3">
                                <div class="col-12">
                                    <div cdkDropList class="example-list" (cdkDropListDropped)="drop2(ix, $event)" formArrayName="exerciseTrainingBindingModels">                
                                        <div [id]="iy" *ngFor="let exercises of days['controls'].exerciseTrainingBindingModels['controls']; let iy=index" [formGroupName]="iy" class="exercise" cdkDrag #elem="cdkDrag" (mouseenter)="enter2(ix, iy)">
                                            
                                            <div class="row mb-3 test">
                                                <i class="fa fa-arrows" aria-hidden="true" cdkDragHandle></i>
                                                <div class="col-12 delete mt-3">
                                                    <i *appHasRole="['Trainer']" (click)="deleteY(ix, iy)" matTooltip="Usuń ćwiczenie" class="material-icons clear-icon">
                                                        clear
                                                    </i>  
                                                    <!-- <input type="button" (click)="deleteY(ix, iy)" value="usuń ćwiczenie"> -->
                                                </div>
                                                <div class="col-12">
                                                    <mat-form-field class="xs">
                                                        <input matInput placeholder="Nazwa ćwiczenia" formControlName="name" required>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-12">
                                                    <mat-form-field class="xs">
                                                        <textarea matInput placeholder="Opis ćwiczenia" formControlName="description"></textarea>
                                                    </mat-form-field>   
                                                </div>                                                
                                            </div>  

                                            <!-- series -->  
                                            <div class="row">
                                                <div class="col-12">           
                                                    <div cdkDropList class="example-list" (cdkDropListDropped)="drop3(ix, iy, $event)" formArrayName="serieBindingModels">                
                                                        <div [id]="iz" *ngFor="let serie of exercises['controls'].serieBindingModels['controls']; let iz=index" [formGroupName]="iz" class="serie" cdkDrag #elem="cdkDrag" (mouseenter)="enter3(ix, iy, iz)">   
                                                            <div class="row mb-3 mt-3 test">
                                                                <i class="fa fa-arrows" aria-hidden="true" cdkDragHandle></i>
                                                                <div class="col-12 delete mt-3">  
                                                                    <i *appHasRole="['Trainer']" (click)="deleteZ(ix, iy, iz)" matTooltip="Usuń ćwiczenie" class="material-icons clear-icon">
                                                                        clear
                                                                    </i>                                                                            
                                                                    <!-- <input type="button" (click)="deleteZ(ix, iy, iz)" value="usuń serie">   -->
                                                                </div> 

                                                                <div class="col-12">                                                         
                                                                    <mat-form-field class="xs">
                                                                        <input matInput placeholder="Ilość powtórzeń" formControlName="number" required>
                                                                    </mat-form-field>
                                                                </div>
                                                                
                                                                <div class="col-12"> 
                                                                    <mat-form-field class="xs">
                                                                        <input matInput placeholder="Jednostka" formControlName="unit" required>
                                                                    </mat-form-field>  
                                                                </div> 
                                                            </div>                                                                               
                                                        </div>                                            
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-12">
                                                    <input type="button" (click)="addZ(ix ,iy)" value="dodaj serie" class="btn btn-info add">
                                                </div>
                                            </div>
                                            <!-- end series -->
                    
                                        </div>                                    
                                    </div>
                                </div>
                            </div>
                        </div>     

                        <div class="row">
                            <div class="col-12">
                                <input type="button" (click)="addY(ix)" value="dodaj ćwiczenie" class="btn btn-primary add">                                  
                            </div>
                        </div>

                        <!-- end exercises -->                          
                    </div>        
                </div>
                <div class="row">
                    <div class="col-12">
                        <input type="button" (click)="addX()" value="dodaj dzień" class="btn btn-warning add">
                    </div>
                </div>
            </div> 
        </div> 

        <!-- <button mat-raised-button color="warn" >Add</button> -->
        <button type="button" class="btn btn-success" type="submit">Zapisz Trening</button>
        </form>              
    </div>
</div>